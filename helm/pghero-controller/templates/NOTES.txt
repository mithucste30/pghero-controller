Thank you for installing {{ .Chart.Name }}.

Your release is named {{ .Release.Name }}.

The PgHero Controller has been successfully deployed!

{{- if .Values.pghero.enabled }}

======================
PgHero is ENABLED
======================

{{- if .Values.pghero.autoReload.enabled }}
⚠️  Auto-reload is enabled. Make sure Reloader is installed:
   kubectl apply -f https://raw.githubusercontent.com/stakater/Reloader/master/deployments/kubernetes/reloader.yaml

When you create/update/delete Database CRDs, PgHero will automatically restart to load the new configuration.
{{- end }}

PgHero Service: {{ include "pghero-controller.fullname" . }}-pghero
{{- if eq .Values.pghero.service.type "NodePort" }}
Access PgHero at: http://<node-ip>:{{ .Values.pghero.service.nodePort }}
{{- end }}

{{- end }}

======================
Creating Databases
======================

To get started, you can create a Database resource:

cat <<EOF | kubectl apply -f -
apiVersion: pghero.mithucste30.io/v1alpha1
kind: Database
metadata:
  name: my-postgres-db
  namespace: {{ .Release.Namespace }}
spec:
  name: production
  url: postgres://user:password@localhost:5432/dbname
  databaseType: postgresql
  enabled: true
EOF

Or reference a secret:

cat <<EOF | kubectl apply -f -
apiVersion: pghero.mithucste30.io/v1alpha1
kind: Database
metadata:
  name: my-postgres-db
  namespace: {{ .Release.Namespace }}
spec:
  name: production
  databaseType: postgresql
  enabled: true
  urlFromSecret:
    name: postgres-credentials
    key: database-url
EOF

To check the status of your databases:

  kubectl get databases -n {{ .Release.Namespace }}

To view the aggregated database configuration:

  kubectl get configmap pghero-databases -n {{ .Release.Namespace }} -o yaml

To view controller logs:

  kubectl logs -n {{ .Release.Namespace }} -l app.kubernetes.io/name={{ include "pghero-controller.name" . }}

{{- if .Values.metrics.enabled }}

Metrics are exposed on port {{ .Values.service.metricsPort }}
{{- if .Values.metrics.serviceMonitor.enabled }}
ServiceMonitor has been created for Prometheus Operator integration.
{{- end }}
{{- end }}

For more information, visit: https://github.com/mithucste30/pghero-controller
